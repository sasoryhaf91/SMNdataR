<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Download and Aggregate Yearly Climate Data (Reduce Format) — smn_dl_yearly_single • SMNdataR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download and Aggregate Yearly Climate Data (Reduce Format) — smn_dl_yearly_single"><meta name="description" content="Downloads daily data for an SMN station using
smn_dl_daily_single() and aggregates to yearly values for one or more
variables, with quality control based on an allowed fraction of missing days
per year. The output is always in reduce (wide) format: one row per year
with the requested variables as columns plus station metadata."><meta property="og:description" content="Downloads daily data for an SMN station using
smn_dl_daily_single() and aggregates to yearly values for one or more
variables, with quality control based on an allowed fraction of missing days
per year. The output is always in reduce (wide) format: one row per year
with the requested variables as columns plus station metadata."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SMNdataR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting started with SMNdataR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sasoryhaf91/SMNdataR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Download and Aggregate <strong>Yearly</strong> Climate Data (Reduce Format)</h1>
      <small class="dont-index">Source: <a href="https://github.com/sasoryhaf91/SMNdataR/blob/master/R/dl_yearly_single.R" class="external-link"><code>R/dl_yearly_single.R</code></a></small>
      <div class="d-none name"><code>smn_dl_yearly_single.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Downloads <strong>daily</strong> data for an SMN station using
<code><a href="smn_dl_daily_single.html">smn_dl_daily_single()</a></code> and aggregates to <strong>yearly</strong> values for one or more
variables, with quality control based on an allowed fraction of missing days
per year. The output is always in <strong>reduce (wide)</strong> format: one row per year
with the requested variables as columns plus station metadata.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smn_dl_yearly_single</span><span class="op">(</span></span>
<span>  <span class="va">station</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"1961-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  max_missing_frac <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  aggregator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  csv_file <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-station">station<a class="anchor" aria-label="anchor" href="#arg-station"></a></dt>
<dd><p>Character or numeric. SMN station code (e.g., <code>"15101"</code>).</p></dd>


<dt id="arg-start-date">start_date<a class="anchor" aria-label="anchor" href="#arg-start-date"></a></dt>
<dd><p>Character or <code>Date</code>. Start of the daily window
(default <code>"1961-01-01"</code>, inclusive).</p></dd>


<dt id="arg-end-date">end_date<a class="anchor" aria-label="anchor" href="#arg-end-date"></a></dt>
<dd><p>Character or <code>Date</code>. End of the daily window
(default <code><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date()</a></code>, inclusive).</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>Character vector of variables to summarize. Any subset of
<code>c("prec","evap","tmax","tmin")</code>. Use <code>"all"</code> to include all four
(default <code>"all"</code>).</p></dd>


<dt id="arg-max-missing-frac">max_missing_frac<a class="anchor" aria-label="anchor" href="#arg-max-missing-frac"></a></dt>
<dd><p>Numeric in [0, 1]. Maximum allowed <strong>fraction of
missing days per year</strong> to keep that year's aggregate for a variable
(default <code>0.2</code>). When the missing fraction exceeds the threshold, that
yearly value is set to <code>NA</code>.</p></dd>


<dt id="arg-aggregator">aggregator<a class="anchor" aria-label="anchor" href="#arg-aggregator"></a></dt>
<dd><p>Either:</p><ul><li><p><code>NULL</code> (default): uses <code>sum</code> for <code>"prec","evap"</code> and <code>mean</code> for
<code>"tmax","tmin"</code>, or</p></li>
<li><p>a <strong>single function</strong> (e.g., <code>median</code>) applied to all variables, or</p></li>
<li><p>a <strong>named list</strong> mapping variables to functions,
e.g. <code>list(prec = sum, evap = sum, tmax = mean, tmin = mean)</code>.</p></li>
</ul></dd>


<dt id="arg-csv-file">csv_file<a class="anchor" aria-label="anchor" href="#arg-csv-file"></a></dt>
<dd><p>Optional file path. If non-<code>NULL</code>, the result is written to
CSV (<code>row.names = FALSE</code>) and also returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A base <code>data.frame</code> in <strong>reduce</strong> (wide) format with columns:
<code>station, latitude, longitude, altitude, YEAR, &lt;variables...&gt;</code>.
If no data are available, returns an empty table with the same schema.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Internally calls <code><a href="smn_dl_daily_single.html">smn_dl_daily_single()</a></code> with <code>output_format = "full"</code> to
fetch daily data and station metadata. The missing-data rule is computed
<strong>per year and per variable</strong> as <code>#(NA) / #(days in year)</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># All variables in reduce format (default)</span></span></span>
<span class="r-in"><span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu">smn_dl_yearly_single</span><span class="op">(</span></span></span>
<span class="r-in"><span>  station <span class="op">=</span> <span class="st">"15101"</span>,</span></span>
<span class="r-in"><span>  start_date <span class="op">=</span> <span class="st">"2000-01-01"</span>,</span></span>
<span class="r-in"><span>  end_date   <span class="op">=</span> <span class="st">"2005-12-31"</span>,</span></span>
<span class="r-in"><span>  variables  <span class="op">=</span> <span class="st">"all"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Subset of variables and custom aggregator</span></span></span>
<span class="r-in"><span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu">smn_dl_yearly_single</span><span class="op">(</span></span></span>
<span class="r-in"><span>  station <span class="op">=</span> <span class="st">"15101"</span>,</span></span>
<span class="r-in"><span>  start_date <span class="op">=</span> <span class="st">"1990-01-01"</span>,</span></span>
<span class="r-in"><span>  end_date   <span class="op">=</span> <span class="st">"1999-12-31"</span>,</span></span>
<span class="r-in"><span>  variables  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prec"</span>,<span class="st">"tmax"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  aggregator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="va">sum</span>, tmax <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hugo Antonio-Fernández.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

